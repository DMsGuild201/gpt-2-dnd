# FROM nikolaik/python-nodejs:python3.6-nodejs12
# FROM python:3.7.3-slim-stretch
FROM tiangolo/uwsgi-nginx-flask:python3.6

RUN apt-get -y update && apt-get -y install gcc

COPY gc_req.txt /app
RUN pip3 --no-cache-dir install -r gc_req.txt -t /app

WORKDIR /app

# RUN npm i -g pm2

RUN mkdir checkpoint

COPY checkpoint/dnd12 /checkpoint/dnd12
COPY gpt_2_simple /app/gpt_2_simple
COPY build /app/build
COPY docker_wrapper.sh /app

# COPY gcloud_app.py /
COPY front.py /app/main.py
COPY generate_one.py /app

RUN apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*


# CMD ./docker_wrapper.sh

# RUN python3 -X utf8 gcloud_app.py

# CMD [ "pm2", "serve", "build", "--spa" ]

# ENTRYPOINT ["python3", "-X", "utf8", "gcloud_app.py"]
